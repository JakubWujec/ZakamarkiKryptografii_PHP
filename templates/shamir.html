<!-- read that https://docs.mathjax.org/en/latest/web/configuration.html#local-configuration-file -->

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Zakamarki Kryptografii </title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" type="text/css" href="../static/index.css">

    <!-- MATHJAX -->
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script type="text/javascript"
            id="MathJax-script"
            async
            src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
    </script>
    <!-- for a dollar sign -->
    <script>
        window.MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']]
            }
        };
    </script>

</head>

<body>

<div class="wrapper">
    <header class="main-header">
        <a href="index.php">
            Zakamarki Kryptografii
        </a>
    </header>

    <main class="content article-content">
        <article id="goldwasser" >
            <h2 class="entry-title">Schemat progowy $(t,n)$ dzielenia sekretu Shamira </h2>
            <img src="../images/man.jpg" alt="man shh">

            <div class="post-content">
                <p><b>Cel:</b> Zaufana Trzecia Strona $T$ ma sekrest $S \geq 0$, który chce podzielić pomiędzy $n$ uczestników
                tak, aby dowolnych $t$ spośród nich mogło sekret odtworzyć.</p>

                <p><b>Faza inicjalizacji:</b></p>
                <ul>
                    <li>$T$ wybiera liczbę pierwszą $p \gt \max{(S,n)} $ i definiuje $a_0 = S $</li>
                    <li>$T$ wybiera losowo i niezależnie $t-1$ współczynników $a_1,\dots,a_{t-1} \in \mathbb{Z}_p$
                    $$ f(x) = a_0 + \sum_{j=1}^{t-1} \frac{a_j}{x^{j}} $$</li>
                    <li> Dla $ 1 \leq i \leq n$ Zaufana Trzecia Strona $T$ wybiera losowo $ x_i \in \mathbb{Z}_p$, oblicza:
                    $S_i = f(x_i) \mod p$ i bezpiecznie przekazuje parę $(x_i,S_i)$ użytkownikowi $P_i$</li>
                </ul>

                <p><b>Faza łączenia udziałów w sekret:</b> Dowolna grupa $t$ lub więcej użytkowników łączy swoje udziały
                - t różnych punktów $(x_i,S_i)$ wielomianu $f$ i dzięki interpolacji Lagrange'a odzyskuje sekret
                $ S = a_0 = f(0) $</p>

                <h2>Interpolacja Lagrange'a </h2>
                <p>Mając dane $t$ różnych punktów $ (x_i,y_i) $ nieznanego wielomianu $f$ stopnia mniejszego od $ t $
                    możemy znać całego wielomianu $f$. Wstawiając do wzoru na interpolację Lagrange'a $ x = 0 $, dostajemy
                    wersję uproszczoną, ale wystarczającą aby policzyć sekret $S=f(0)$:
                    $$ f(x) = \sum_{i=1}^{t} \left(y_i \prod_{1 \leq j \leq t, j \neq i } \frac{x-x_i}{x_i - x_j} \right)\mod{p} $$</p>

                <p><b>Wskazówka:</b> w schemacie Shamira, aby odzyskać sekret $S$, użytkownicy nie muszą znać całego wielomianu
                    $f$. Wstawiając do wzoru na interpolację Lagrange'a $x = 0$, dostajemy wersję uproszczoną, ale wystarczającą
                    aby policzyć sekret $S=f(0)$:
                    $$ f(x) = \sum_{i=1}^{t} \left(y_i \prod_{1 \leq j \leq t, j \neq i } \frac{x_j}{x_j - x_i} \right)\mod{p} $$
                </p>


                <h2>Przykład !!! Przykład !!! Przykład </h2>
                <p>Czyli coś dzięki czemu można to zrozumieć. Specjalnie wybrałem małe wartości by łatwiej było to ogarnąć.
                Niech $$ S=3 \textrm{, } t=3  \textrm{, } n=4 \textrm{, }  p=5  $$
                Zatem pracujemy w $ \mathbb{Z}_5 \textrm{ i } a_0=3 $
                    Losowo i niezależnie wybieram współczynniki $$ a_1=2 \textrm{ i } a_2=4 $$
                    Stąd otrzymuje funkcję $$ f(x)=3+2x+4x^2 $$

                    Następnie znowu losowo i niezależnie wybieram $x_i$ i obliczam $S_i$ (CAŁY CZAS PRACUJEMY W $\mathbb{Z}_5$)
                    \begin{eqnarray}
                    x_1 = 0 \textrm{, } \quad S_1=f(x_1)=3 \\
                    x_2 = 2 \textrm{, } \quad S_2=f(x_2)=3 \\
                    x_3 = 1 \textrm{, } \quad S_3=f(x_3)=4 \\
                    x_4 = 4 \textrm{, } \quad S_4=f(x_4)=0 \\
                    \end{eqnarray}

                    I teraz odpowiednie pary $(x_i,S_i)$ przekazujemy użytkownikowi $P_i$
                    <br>
                    Teraz możemy to sprawdzić wybierając pary $(x_i,S_i)$ od $t$ użytkowników. Niech to będą pary
                    $$p_1=(0,3) \textrm{, } p_2=(2,3) \textrm{, } p_4=(4,0) $$
                    (CAŁY CZAS W $\mathbb{Z}_5$ !!!)

                    \begin{eqnarray}
                    i=1 \textrm{,} \quad 3\left(\frac{x-2}{0-2}\right)\left(\frac{x-4}{0-4}\right) &=& x^2+4x+3 \\
                    i=2 \textrm{,} \quad 3\left(\frac{x-0}{2-0}\right)\left(\frac{x-4}{2-4}\right) &=& 3x^2+3x \\
                    i=3 \textrm{,} \quad 0\left(\frac{x-0}{4-0}\right)\left(\frac{x-2}{4-2}\right) &=& 0 \\
                    \textrm{w sumie} \quad f(x)=4x^2+2x+3
                    \end{eqnarray}
                    Czyli to jest dokładnie nasza funkcja. Obliczenie sekretu jest już tylko formalnością.
                    $$ S = a_0 = f(0) = 3 $$

                </p>

            </div>

        </article>
    </main>

</div> <!-- end wrapper -->

</body>


</html>
